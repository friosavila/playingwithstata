<span class="stinp">. clear</span>

<span class="stinp">. set seed 1101</span>

<span class="stinp">. set obs 250</span>
number of observations (_N) was 0, now 250

<span class="stinp">. gen x = 2+rnormal()/2</span>

<span class="stinp">. gen z = runiform()&gt;.5</span>

<span class="stinp">. gen v = rnormal()</span>

<span class="stinp">. replace x=. if x&gt;5  <span class="stcmt">// Dropping large values for the graph</span></span>
(0 real changes made)

<span class="stinp">. replace x=1.5 in 1/2  <span class="stcmt">// but setting two points of interest</span></span>
(2 real changes made)

<span class="stinp">. replace z=0 in 1</span>
(0 real changes made)

<span class="stinp">. replace z=1 in 2</span>
(0 real changes made)

<span class="stinp">.  gen zero=0</span>

<span class="stinp">. <span class="stcmt">* finally, following the DGP, we have:</span></span>
<span class="stinp">. gen y = 2 + 1*x - 2*z + 2*x*z + v * (1+x+z)</span>

<span class="stinp">. gen id = _n</span>

<span class="stinp">. two (scatter y    x  if z==0 ,  color(navy%20)  ) || <span class="stcmt">///</span>
&gt;         (scatter y    x  if z==1 ,  color(maroon%20)  ) || <span class="stcmt">///</span>
&gt;         (scatter y    x  in 1/5 if z==0, mlabel(id) mlabcolor(black) mlabpos(12
&gt; ) color(navy%80)  )  <span class="stcmt">///</span>
&gt;         (scatter y    x  in 1/5 if z==1, mlabel(id) mlabcolor(black) mlabpos(12
&gt; ) color(maroon%80)  ) , <span class="stcmt">///</span>
&gt;         legend(order(1 "y if z=0" 2 "y if z=1") bplace(nw) position(center) col
&gt; s(1) region(lstyle(none))  )   xlabel(0.5 1/3 3.5) ylabel(-5 (5) 22)</span>
