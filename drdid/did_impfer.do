** How to do Imputation based on this strategy
use "C:\Users\user\Documents\GitHub\playingwithstata\drdid\mpdta.dta", clear
 
** ID being treated variable
gen trt=(year>=first_treat)*first_treat
** treat

** define Sample=0
** This imputes based on some data trends
qui:reg lemp i.year i.countyreal if trt==0, 
predictnl dy=lemp-xb()

** 
gen trt1=trt>0
** simple
reg dy i.trt1 , cluster(countyreal)
** Group effects
reg dy i.trt , cluster(countyreal)
** year effects
gen yeff=year*trt1
reg dy i.yeff, cluster(countyreal)
** Event
gen event=(year-first+1)*treat
gen eev=event+3
reg dy lpop ib3.eev, cluster(countyreal)
 ss
/*
------------------------------------------------------------------------------
             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
      simple |  -.0417577   .0115008    -3.63   0.000    -.0642989   -.0192165
------------------------------------------------------------------------------
Group Effects

------------------------------------------------------------------------------
             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
       g2004 |  -.0845806   .0245609    -3.44   0.001    -.1327192   -.0364421
       g2006 |  -.0201825   .0174622    -1.16   0.248    -.0544077    .0140427
       g2007 |  -.0287821   .0162333    -1.77   0.076    -.0605988    .0030347
------------------------------------------------------------------------------
Time Estimated Effects

------------------------------------------------------------------------------
             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
       t2004 |  -.0145329   .0221264    -0.66   0.511       -.0579    .0288341
       t2005 |  -.0764267   .0286661    -2.67   0.008    -.1326113   -.0202422
       t2006 |  -.0461863   .0211994    -2.18   0.029    -.0877363   -.0046363
       t2007 |   -.039587   .0129245    -3.06   0.002    -.0649185   -.0142556
------------------------------------------------------------------------------
Event Studies:Dynamic effects

------------------------------------------------------------------------------
             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
         E_3 |   .0266993   .0140628     1.90   0.058    -.0008633    .0542619
         E_2 |  -.0036597   .0129229    -0.28   0.777    -.0289881    .0216686
         E_1 |  -.0232621   .0144819    -1.61   0.108    -.0516462     .005122
          E0 |   -.021064   .0114933    -1.83   0.067    -.0435904    .0014625
          E1 |  -.0530171   .0163437    -3.24   0.001    -.0850501   -.0209841
          E2 |  -.1404536    .035373    -3.97   0.000    -.2097834   -.0711239
          E3 |  -.1069093   .0328863    -3.25   0.001    -.1713652   -.0424533
------------------------------------------------------------------------------
*/